<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026ë¡œë˜ë¨¸ì‹  & ë¡œë˜ ë¶„ì„ ë°ì´í„°</title>
    <style>
        /* ê¸°ë³¸ ë¦¬ì…‹ / ë°•ìŠ¤ ì‚¬ì´ì§• */
        *, *::before, *::after { box-sizing: border-box; }

        :root{
            --primary:#6e8efb;
            --accent:#a777e3;
            --bg:#f8f9fa;
            --card:#ffffff;
            --muted:#666;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--bg);
        }

        header {
            text-align: center;
            padding: 28px 16px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .container {
            display: flex;
            gap: 30px;
            background: var(--card);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.08);
            margin-bottom: 30px;
            align-items: flex-start;
        }

        .app-image {
            flex: 0 0 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .app-image img {
            width: 100%;
            max-width: 300px;
            border-radius: 16px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.12);
            height: auto;
            object-fit: contain;
        }

        .app-info {
            flex: 1;
            min-width: 0;
        }

        h1 { margin: 0 0 8px 0; font-size: 1.6rem; }
        h2 { margin-top: 0; }
        p { margin: 0 0 8px 0; }

        .feature-list {
            list-style: none;
            padding: 0;
            margin: 12px 0 18px 0;
        }
        .feature-list li {
            margin-bottom: 10px;
            padding-left: 26px;
            position: relative;
            word-break: keep-all;
        }
        .feature-list li::before {
            content: 'âœ¨';
            position: absolute;
            left: 0;
            top: 0;
        }

        .stats-container {
            background: var(--card);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.08);
        }

        /* Tabs Style */
        .tabs {
            display: flex;
            border-bottom: 2px solid #eee;
            margin-bottom: 16px;
            gap: 8px;
            flex-wrap: wrap;
        }
        .tab-btn {
            padding: 8px 14px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            font-weight: 700;
            color: #888;
            transition: 0.2s;
            border-radius: 8px 8px 0 0;
        }
        .tab-btn.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }

        .stats-header {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 12px;
            min-height: 40px;
        }
        .search-area {
            position: absolute;
            right: 0;
        }
        .search-area select {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 0.95rem;
            background: #fff;
        }

        .lotto-balls {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            margin: 18px 0;
            flex-wrap: wrap;
        }
        .ball {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
            flex: 0 0 auto;
        }
        .ball.yellow { background: #fbc400; color: #222; }
        .ball.blue { background: #69c8f2; }
        .ball.red { background: #ff7272; }
        .ball.gray { background: #aaaaaa; }
        .ball.green { background: #b0d840; color: #222; }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-top: 12px;
        }
        .analysis-item {
            background: #f1f3f5;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
        }
        .analysis-item span {
            display: block;
            font-size: 0.85em;
            color: var(--muted);
        }
        .analysis-item strong {
            font-size: 1.05em;
            color: #333;
        }

        /* Frequency Table Style */
        .freq-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 14px;
        }
        .freq-item {
            background: #fff;
            border: 1px solid #eee;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: help;
            transition: background 0.15s;
        }
        .freq-item:hover {
            background: #f8f9fa;
        }
        .freq-item .ball {
            margin: 0 auto 6px;
            width: 30px;
            height: 30px;
            font-size: 14px;
        }
        .freq-count {
            font-size: 0.85em;
            color: var(--muted);
        }
        .freq-count strong { color: #e64980; }

        /* Analysis Tab Style */
        .analysis-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            background: #f1f3f5;
            padding: 15px;
            border-radius: 10px;
        }
        .analysis-controls select, .analysis-controls button {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-size: 0.95rem;
        }
        .analysis-controls button {
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        .analysis-controls button:hover {
            opacity: 0.9;
        }
        .analysis-result-section {
            margin-bottom: 24px;
            padding: 16px;
            background: #fff;
            border: 1px solid #eee;
            border-radius: 10px;
        }
        .analysis-result-section h4 {
            margin-top: 0;
            color: var(--primary);
            border-bottom: 2px solid #f1f3f5;
            padding-bottom: 8px;
            margin-bottom: 12px;
        }
        .result-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .result-list li {
            padding: 6px 0;
            border-bottom: 1px dashed #eee;
            font-size: 0.95rem;
        }
        .result-list li:last-child { border-bottom: none; }

        footer {
            text-align: center;
            margin-top: 36px;
            color: #888;
            font-size: 0.9em;
        }

        /* ë°˜ì‘í˜•: íƒœë¸”ë¦¿ ì´í•˜ */
        @media (max-width: 900px) {
            .container {
                gap: 18px;
                padding: 22px;
            }
            .app-image { flex: 0 0 220px; }
            .app-image img { max-width: 220px; }
            .tab-btn { padding: 7px 12px; font-size: 0.95rem; }
            .ball { width: 36px; height: 36px; font-size: 16px; }
        }

        /* ë°˜ì‘í˜•: ëª¨ë°”ì¼ */
        @media (max-width: 600px) {
            body { padding: 12px; }
            header { padding: 20px 12px; border-radius: 10px; }
            .container {
                flex-direction: column;
                padding: 16px;
                gap: 14px;
            }
            .app-image {
                flex: 0 0 auto;
            }
            .app-image img {
                max-width: 100%;
                width: 180px;
                height: auto;
            }
            .stats-container { padding: 16px; }
            .search-area {
                position: static;
                display: flex;
                justify-content: flex-end;
                margin-top: 8px;
            }
            .stats-header { align-items: flex-start; text-align: center; flex-direction: column; gap: 6px; }
            .lotto-balls { gap: 8px; margin: 12px 0; }
            .ball { width: 34px; height: 34px; font-size: 15px; }
            .freq-grid { grid-template-columns: repeat(auto-fill, minmax(64px, 1fr)); gap: 8px; }
            .analysis-grid { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; }
            .analysis-controls { flex-direction: column; }
            .analysis-controls select, .analysis-controls button { width: 100%; }
        }

        /* ì•„ì£¼ ì‘ì€ í™”ë©´(ì¢ì€ í°) */
        @media (max-width: 380px) {
            h1 { font-size: 1.2rem; }
            .app-image img { width: 150px; }
            .ball { width: 30px; height: 30px; font-size: 14px; }
            .freq-item .ball { width: 26px; height: 26px; font-size: 13px; margin-bottom: 4px; }
            .tab-btn { font-size: 0.9rem; padding: 6px 8px; }
        }

    </style>
</head>
<body>

<header>
    <h1>2026ë¡œë˜ë¨¸ì‹ </h1>
    <p>ì¬ë°Œê³  ì¦ê±°ìš´ í–‰ìš´ìˆ«ì ë½‘ê¸°</p>
</header>

<div class="container">
    <div class="app-image">
        <img src="images/2026lottomachine.png" alt="2026ë¡œë˜ë¨¸ì‹ ">
    </div>
    <div class="app-info">
        <h2>âœ¨ ì£¼ìš” ê¸°ëŠ¥ ì†Œê°œ</h2>
        <ul class="feature-list">
            <li><strong>ë¬¼ë¦¬ ì—”ì§„</strong>ì„ ì´ìš©í•œ ì¬ë°ŒëŠ” ì¶”ì²¨</li>
            <li>ë¹ ë¥´ê²Œ ë‚´ ì…ë§›ì— ë§ëŠ” ìˆ«ìë“¤ì„ ê³ ë¥¼ìˆ˜ ìˆëŠ” <strong>ì»¤ìŠ¤í…€ëª¨ë“œ</strong></li>
            <li>AIê°€ ì¶”ì²¨í•´ í™•ë¥ ì„ ëŒì–´ì˜¬ë¦° <strong>AIì¶”ì²œëª¨ë“œ</strong></li>
            <li>ë‹¤ë¥¸ ì‚¬ëŒì€ ì„ íƒí•˜ì§€ ì•Šì„ê²ƒ ê°™ì€ ë‚˜ë§Œì˜ <strong>í¬ê·€ëª¨ë“œ</strong></li>
            <li>í† ìš”ì¼ 10ì‹œ 30ë¶„. ë‹¹ì²¨ í™•ì¸ê¹Œì§€ <strong>ìë™ì•Œë¦¼ëª¨ë“œ</strong></li>
            <li>ì¶”ì²¨í•œ ë²ˆí˜¸ë¥¼ ì§€ì¸ë“¤ê³¼ ê³µìœ í•˜ì„¸ìš”.</li>
            <li>êµ¬ì…í•œ ìš©ì§€ë¥¼ <strong>QR ì½”ë“œ</strong> ì €ì¥í•˜ê³  ë‹¹ì²¨ í™•ì¸ê¹Œì§€</li>
        </ul>

        <h3>ğŸš€ v1.0.2 ì—…ë°ì´íŠ¸ ìƒì„¸ ë‚´ì—­</h3>
        <ul>
            <li>[ì‹ ê·œ] QR ìŠ¤ìºë„ˆ íƒ‘ì¬: ì¹´ë©”ë¼ë¥¼ ë¹„ì¶”ê¸°ë§Œ í•˜ë©´ ë‹¹ì²¨ ë²ˆí˜¸ë¥¼ ì¦‰ì‹œ ì¸ì‹í•©ë‹ˆë‹¤.</li>
            <li>[ê°œì„ ] ì‹œë®¬ë ˆì´ì…˜ ì •ë°€ë„ í–¥ìƒ: ê³µì˜ ì›€ì§ì„ì„ ë”ìš± ìì—°ìŠ¤ëŸ½ê²Œ ë³´ì •í–ˆìŠµë‹ˆë‹¤.</li>
            <li>[ìµœì í™”] ì•± ì•ˆì •ì„± ë° ì„±ëŠ¥ ê°œì„ </li>
            <li>[ë””ìì¸] ë‹¤í¬ ëª¨ë“œ ë° í…Œë§ˆ ìµœì í™”</li>
        </ul>

        <div style="background: #fff9db; padding: 12px; border-radius: 10px; border-left: 5px solid #fab005;">
            <strong>ê°œë°œì í•œë§ˆë””:</strong> "ì—¬ëŸ¬ë¶„ì˜ ë‹¹ì²¨ í™•ë¥  1%ë¼ë„ ë” ì˜¬ë¦¬ê¸° ìœ„í•´ ì¶”ì²¨ ì—”ì§„ì„ ê°ˆì•„ ë„£ì—ˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì£¼ ì£¼ì¸ê³µì€ ë°”ë¡œ ë‹¹ì‹ ì…ë‹ˆë‹¤[...]
        </div>
    </div>
</div>

<div class="stats-container">
    <div class="tabs">
        <button class="tab-btn active" onclick="openTab('result-tab', event)">ë‹¹ì²¨ ê²°ê³¼</button>
        <button class="tab-btn" onclick="openTab('freq-tab', event)">ë²ˆí˜¸ë³„ ë¹ˆë„</button>
        <button class="tab-btn" onclick="openTab('analysis-tab', event)">íŒ¨í„´ ë¶„ì„</button>
    </div>

    <!-- ë‹¹ì²¨ ê²°ê³¼ íƒ­ -->
    <div id="result-tab" class="tab-content active">
        <div class="stats-header">
            <h3 id="latest-round-title" style="margin: 0; color: #666; text-align: center;">ë¡œë”© ì¤‘...</h3>
            <div class="search-area">
                <select id="round-select" onchange="loadSpecificRound(this.value)">
                    <option value="">íšŒì°¨ ì„ íƒ</option>
                </select>
            </div>
        </div>

        <div id="lotto-balls-container" class="lotto-balls"></div>

        <div class="analysis-grid">
            <div class="analysis-item">
                <span>í™€ì§ ë¹„ìœ¨</span>
                <strong id="odd-even-ratio">-</strong>
            </div>
            <div class="analysis-item">
                <span>ì´í•©</span>
                <strong id="sum-value">-</strong>
            </div>
            <div class="analysis-item">
                <span>ACê°’</span>
                <strong id="ac-value">-</strong>
            </div>
            <div class="analysis-item">
                <span>ê³ ì € ë¹„ìœ¨</span>
                <strong id="high-low-ratio">-</strong>
            </div>
        </div>

        <div style="margin-top: 16px; text-align: center; padding: 12px; background: #e7f5ff; border-radius: 10px;">
            1ë“± ë‹¹ì²¨ì ìˆ˜: <strong id="winners-count">-</strong> | 1ì¸ë‹¹ ë‹¹ì²¨ê¸ˆ: <strong id="amount-per-winner">-</strong>
        </div>
    </div>

    <!-- ë²ˆí˜¸ë³„ ë¹ˆë„ íƒ­ -->
    <div id="freq-tab" class="tab-content">
        <h3 style="text-align: center; color: #666;">ë²ˆí˜¸ë³„ ëˆ„ì  ì¶œí˜„ ë¹ˆë„ (ë³´ë„ˆìŠ¤ í¬í•¨)</h3>
        <div id="freq-container" class="freq-grid">
            <!-- JavaScriptì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
        </div>
    </div>

    <!-- íŒ¨í„´ ë¶„ì„ íƒ­ -->
    <div id="analysis-tab" class="tab-content">
        <div class="analysis-controls">
            <select id="start-round-select">
                <option value="">ì‹œì‘ íšŒì°¨</option>
            </select>
            <span>~</span>
            <select id="end-round-select">
                <option value="">ì¢…ë£Œ íšŒì°¨</option>
            </select>
            <button onclick="runAnalysis()">ë¶„ì„ ì‹¤í–‰</button>
        </div>

        <div id="analysis-results" style="display: none;">
            <div class="analysis-result-section">
                <h4>ğŸ“Š ê¸°ë³¸ í†µê³„</h4>
                <ul class="result-list" id="basic-stats-list"></ul>
            </div>

            <div class="analysis-result-section">
                <h4>ğŸ”¥ ìµœë‹¤ ì¶œí˜„ ë²ˆí˜¸ (Top 5)</h4>
                <ul class="result-list" id="top-nums-list"></ul>
            </div>

            <div class="analysis-result-section">
                <h4>â„ï¸ ë¯¸ì¶œí˜„ ë²ˆí˜¸</h4>
                <div id="missing-nums-list" style="word-break: break-all; color: #888;"></div>
            </div>

            <div class="analysis-result-section">
                <h4>ğŸ”„ ì´ì›”ìˆ˜ (ì „íšŒì°¨ ë²ˆí˜¸ ì¬ì¶œí˜„)</h4>
                <ul class="result-list" id="carryover-list"></ul>
            </div>

            <div class="analysis-result-section">
                <h4>ğŸ”¢ ëìˆ˜ ë¶„ì„ (1ì˜ ìë¦¬)</h4>
                <ul class="result-list" id="ending-digit-list"></ul>
            </div>

            <div class="analysis-result-section">
                <h4>ğŸ”— ì—°ë²ˆ ì¶œí˜„ (ì—°ì†ëœ ìˆ«ì)</h4>
                <div id="consecutive-stats"></div>
            </div>
        </div>
        <div id="analysis-loading" style="display: none; text-align: center; padding: 20px;">
            ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...
        </div>
    </div>
</div>

<footer>
    <p>&copy; 2026 ë¡œë˜ë¨¸ì‹  í”„ë¡œì íŠ¸. All rights reserved.</p>
</footer>

<script>
    let currentLatestRound = 0;
    let allLottoData = {}; // ìºì‹±ìš©

    function openTab(tabId, ev) {
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        if (ev && ev.currentTarget) ev.currentTarget.classList.add('active');

        if (tabId === 'freq-tab') {
            loadFrequencyData();
        }
    }

    const getBallColor = (n) => {
        if (n <= 10) return 'yellow';
        if (n <= 20) return 'blue';
        if (n <= 30) return 'red';
        if (n <= 40) return 'gray';
        return 'green';
    };

    async function loadSpecificRound(round) {
        if (!round) return;
        try {
            const start = Math.floor((parseInt(round) - 1) / 1000) * 1000 + 1;
            const folder = `${start}-${start + 999}`;
            const dataRes = await fetch(`lotto_data/${folder}/${round}.lotto`);
            const data = await dataRes.json();
            updateUI(data);
        } catch (e) {
            console.error('íšŒì°¨ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', e);
        }
    }

    function updateUI(data) {
        document.getElementById('latest-round-title').textContent = `ì œ ${data.round}íšŒ ë‹¹ì²¨ ê²°ê³¼`;

        const ballsContainer = document.getElementById('lotto-balls-container');
        ballsContainer.innerHTML = '';
        data.numbers.forEach(num => {
            const ball = document.createElement('div');
            ball.className = `ball ${getBallColor(num)}`;
            ball.textContent = num;
            ballsContainer.appendChild(ball);
        });

        const plus = document.createElement('div');
        plus.style.cssText = 'font-size: 20px; align-self: center;';
        plus.textContent = '+';
        ballsContainer.appendChild(plus);

        const bonusBall = document.createElement('div');
        bonusBall.className = `ball ${getBallColor(data.bonus)}`;
        bonusBall.textContent = data.bonus;
        ballsContainer.appendChild(bonusBall);

        document.getElementById('odd-even-ratio').textContent = data.analysis.odd_even_ratio;
        document.getElementById('sum-value').textContent = data.analysis.sum_value;
        document.getElementById('ac-value').textContent = data.analysis.ac_value;
        document.getElementById('high-low-ratio').textContent = data.analysis.high_low_ratio;
        document.getElementById('winners-count').textContent = `${data.winners}ëª…`;

        const amountEok = (data.amount_per_winner / 100000000).toFixed(1);
        document.getElementById('amount-per-winner').textContent = `ì•½ ${amountEok}ì–µì›`;
    }

    async function init() {
        try {
            const latestRes = await fetch('lotto_data/latest.lotto');
            const latestRound = (await latestRes.text()).trim();
            currentLatestRound = parseInt(latestRound);

            // ì…€ë ‰íŠ¸ ë°•ìŠ¤ ì±„ìš°ê¸° (ê²°ê³¼ íƒ­)
            const select = document.getElementById('round-select');
            // ë¶„ì„ íƒ­ ì…€ë ‰íŠ¸ ë°•ìŠ¤
            const startSelect = document.getElementById('start-round-select');
            const endSelect = document.getElementById('end-round-select');

            for (let i = currentLatestRound; i >= 1; i--) {
                const opt = document.createElement('option');
                opt.value = i;
                opt.textContent = `${i}íšŒ`;
                select.appendChild(opt);

                const optStart = document.createElement('option');
                optStart.value = i;
                optStart.textContent = `${i}íšŒ`;
                startSelect.appendChild(optStart);

                const optEnd = document.createElement('option');
                optEnd.value = i;
                optEnd.textContent = `${i}íšŒ`;
                endSelect.appendChild(optEnd);
            }

            // ë¶„ì„ íƒ­ ê¸°ë³¸ê°’ ì„¤ì • (ìµœê·¼ 10íšŒ)
            startSelect.value = Math.max(1, currentLatestRound - 9);
            endSelect.value = currentLatestRound;

            loadSpecificRound(latestRound);
        } catch (e) {
            console.error('ì´ˆê¸°í™” ì‹¤íŒ¨:', e);
        }
    }

    async function loadFrequencyData() {
        const container = document.getElementById('freq-container');
        if (container.children.length > 0) return; // ì´ë¯¸ ë¡œë“œë¨

        try {
            const res = await fetch('lotto_data/frequency.lotto');
            const data = await res.json();

            // 1ë²ˆë¶€í„° 45ë²ˆê¹Œì§€ ìˆœì„œëŒ€ë¡œ í‘œì‹œ
            for (let i = 1; i <= 45; i++) {
                const stat = data.stats[i];
                const item = document.createElement('div');
                item.className = 'freq-item';
                // ë§ˆìš°ìŠ¤ í˜¸ë²„ ì‹œ ìƒì„¸ íšŸìˆ˜ í‘œì‹œ (title ì†ì„± ì‚¬ìš©)
                item.title = `ë‹¹ì²¨: ${stat.main}íšŒ / ë³´ë„ˆìŠ¤: ${stat.bonus}íšŒ`;
                item.innerHTML = `
                    <div class="ball ${getBallColor(i)}">${i}</div>
                    <div class="freq-count"><strong>${stat.total}</strong>íšŒ</div>
                `;
                container.appendChild(item);
            }
        } catch (e) {
            console.error('ë¹ˆë„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', e);
        }
    }

    // ==========================================
    // ë¶„ì„ ë¡œì§ (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ êµ¬í˜„)
    // ==========================================
    async function getRoundData(round) {
        if (allLottoData[round]) return allLottoData[round];

        const start = Math.floor((parseInt(round) - 1) / 1000) * 1000 + 1;
        const folder = `${start}-${start + 999}`;
        try {
            const res = await fetch(`lotto_data/${folder}/${round}.lotto`);
            if (!res.ok) return null;
            const data = await res.json();
            allLottoData[round] = data;
            return data;
        } catch (e) {
            return null;
        }
    }

    async function runAnalysis() {
        const startRound = parseInt(document.getElementById('start-round-select').value);
        const endRound = parseInt(document.getElementById('end-round-select').value);

        if (startRound > endRound) {
            alert("ì‹œì‘ íšŒì°¨ê°€ ì¢…ë£Œ íšŒì°¨ë³´ë‹¤ í´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }

        document.getElementById('analysis-results').style.display = 'none';
        document.getElementById('analysis-loading').style.display = 'block';

        const dataset = [];
        // ë°ì´í„° ìˆ˜ì§‘
        for (let r = startRound; r <= endRound; r++) {
            const d = await getRoundData(r);
            if (d) dataset.push(d);
        }

        if (dataset.length === 0) {
            alert("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            document.getElementById('analysis-loading').style.display = 'none';
            return;
        }

        // ë¶„ì„ ìˆ˜í–‰
        analyzeDataset(dataset);

        document.getElementById('analysis-loading').style.display = 'none';
        document.getElementById('analysis-results').style.display = 'block';
    }

    function analyzeDataset(dataset) {
        // 1. ê¸°ë³¸ í†µê³„ (ì´í•© í‰ê·  ë“±)
        const sums = dataset.map(d => d.analysis.sum_value);
        const avgSum = sums.reduce((a, b) => a + b, 0) / sums.length;

        const basicList = document.getElementById('basic-stats-list');
        basicList.innerHTML = `
            <li>ë¶„ì„ êµ¬ê°„: ${dataset[0].round}íšŒ ~ ${dataset[dataset.length-1].round}íšŒ (ì´ ${dataset.length}íšŒ)</li>
            <li>í‰ê·  ì´í•©: <strong>${avgSum.toFixed(1)}</strong> (ìµœì†Œ: ${Math.min(...sums)}, ìµœëŒ€: ${Math.max(...sums)})</li>
        `;

        // 2. ë²ˆí˜¸ ë¹ˆë„
        const numCounts = {};
        dataset.forEach(d => {
            d.numbers.forEach(n => {
                numCounts[n] = (numCounts[n] || 0) + 1;
            });
        });

        // Top 5
        const sortedNums = Object.entries(numCounts).sort((a, b) => b[1] - a[1]);
        const topList = document.getElementById('top-nums-list');
        topList.innerHTML = '';
        sortedNums.slice(0, 5).forEach(([num, count]) => {
            const li = document.createElement('li');
            li.innerHTML = `<span class="ball ${getBallColor(num)}" style="width:24px;height:24px;font-size:12px;display:inline-flex;margin-right:6px;">${num}</span> <strong>${count}íšŒ</strong> ì¶œí˜„`;
            topList.appendChild(li);
        });

        // ë¯¸ì¶œí˜„ ë²ˆí˜¸
        const appeared = new Set(Object.keys(numCounts).map(Number));
        const missing = [];
        for(let i=1; i<=45; i++) {
            if(!appeared.has(i)) missing.push(i);
        }
        document.getElementById('missing-nums-list').textContent = missing.length > 0 ? missing.join(', ') : "ì—†ìŒ (ëª¨ë“  ë²ˆí˜¸ ì¶œí˜„)";

        // 3. ì´ì›”ìˆ˜ ë¶„ì„
        const carryoverCounts = {};
        for(let i=1; i<dataset.length; i++) {
            const prev = new Set(dataset[i-1].numbers);
            const curr = new Set(dataset[i].numbers);
            const intersection = [...prev].filter(x => curr.has(x)).length;
            carryoverCounts[intersection] = (carryoverCounts[intersection] || 0) + 1;
        }
        const carryList = document.getElementById('carryover-list');
        carryList.innerHTML = '';
        if (Object.keys(carryoverCounts).length === 0) {
             carryList.innerHTML = '<li>ë°ì´í„° ë¶€ì¡± (2íšŒì°¨ ì´ìƒ í•„ìš”)</li>';
        } else {
            Object.entries(carryoverCounts).sort((a,b) => a[0] - b[0]).forEach(([cnt, freq]) => {
                const ratio = (freq / (dataset.length - 1) * 100).toFixed(1);
                carryList.innerHTML += `<li><strong>${cnt}ê°œ</strong> ì´ì›”: ${freq}íšŒ (${ratio}%)</li>`;
            });
        }

        // 4. ëìˆ˜ ë¶„ì„
        const endingCounts = {};
        dataset.forEach(d => {
            d.numbers.forEach(n => {
                const digit = n % 10;
                endingCounts[digit] = (endingCounts[digit] || 0) + 1;
            });
        });
        const sortedEndings = Object.entries(endingCounts).sort((a, b) => b[1] - a[1]);
        const endList = document.getElementById('ending-digit-list');
        endList.innerHTML = '';
        sortedEndings.slice(0, 3).forEach(([digit, count]) => {
            endList.innerHTML += `<li><strong>${digit}ë</strong> (ì˜ˆ: ${digit}, ${parseInt(digit)+10}...): ì´ ${count}íšŒ</li>`;
        });

        // 5. ì—°ë²ˆ ë¶„ì„
        let consecutiveCount = 0;
        dataset.forEach(d => {
            const nums = [...d.numbers].sort((a,b) => a-b);
            let has = false;
            for(let i=0; i<nums.length-1; i++) {
                if(nums[i+1] === nums[i] + 1) {
                    has = true;
                    break;
                }
            }
            if(has) consecutiveCount++;
        });
        const consecRatio = (consecutiveCount / dataset.length * 100).toFixed(1);
        document.getElementById('consecutive-stats').innerHTML = `
            ì´ <strong>${consecutiveCount}íšŒ</strong> ë°œìƒ (${consecRatio}%)<br>
            <span style="font-size:0.85em; color:#888;">(ì—°ì†ëœ ìˆ«ìê°€ í•˜ë‚˜ë¼ë„ í¬í•¨ëœ íšŒì°¨ ë¹„ìœ¨)</span>
        `;
    }

    init();
</script>

</body>
</html>
